{% extends "base.html" %}

{% block content %}
<a href="{{ url_for('uploads') }}" class="back-link">
    ‚Üê Back to Analysis History
</a>

<section class="section">
    <h2 class="section-title">
        <span class="icon">üìä</span>
        {{ result.trial_name }}
    </h2>
    
    <!-- Key Metrics -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value">{{ result.calculated_steps }}</div>
            <div class="stat-label">Calculated Steps</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-value">{{ result.distance }}</div>
            <div class="stat-label">Distance</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-value">{{ result.time }}</div>
            <div class="stat-label">Time</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-value">
                {% if result.delta != "N/A" %}
                    {% if result.delta|int == 0 %}
                        <span style="color: var(--success-green);">Perfect</span>
                    {% elif result.delta|int|abs <= 5 %}
                        <span style="color: var(--warning-orange);">Œî{{ result.delta }}</span>
                    {% else %}
                        <span style="color: var(--error-red);">Œî{{ result.delta }}</span>
                    {% endif %}
                {% else %}
                    N/A
                {% endif %}
            </div>
            <div class="stat-label">Accuracy</div>
        </div>
    </div>
    
    <!-- Details Grid -->
    <div class="form-grid" style="margin-top: 2rem;">
        <div>
            <h3 class="form-section-title">
                <span>üë§</span>
                User Information
            </h3>
            <table style="width: 100%;">
                <tr>
                    <td style="color: var(--text-secondary); padding: 0.5rem 0;">Gender</td>
                    <td style="padding: 0.5rem 0;">{{ result.gender }}</td>
                </tr>
                <tr>
                    <td style="color: var(--text-secondary); padding: 0.5rem 0;">Height</td>
                    <td style="padding: 0.5rem 0;">{{ result.height }}</td>
                </tr>
                <tr>
                    <td style="color: var(--text-secondary); padding: 0.5rem 0;">Stride Length</td>
                    <td style="padding: 0.5rem 0;">{{ result.stride }}</td>
                </tr>
            </table>
        </div>

        <div>
            <h3 class="form-section-title">
                <span>‚öôÔ∏è</span>
                Trial Information
            </h3>
            <table style="width: 100%;">
                <tr>
                    <td style="color: var(--text-secondary); padding: 0.5rem 0;">Sample Rate</td>
                    <td style="padding: 0.5rem 0;">{{ result.rate }}</td>
                </tr>
                <tr>
                    <td style="color: var(--text-secondary); padding: 0.5rem 0;">Actual Steps</td>
                    <td style="padding: 0.5rem 0;">{{ result.actual_steps }}</td>
                </tr>
            </table>
        </div>
    </div>
</section>

<!-- Signal Processing Visualization -->
<h2 class="section-title" style="margin-top: 2rem; margin-bottom: 1rem;">
    <span class="icon">üìà</span>
    Signal Processing Visualization
</h2>

<div class="plot-container">
    <h3 class="plot-title">Acceleration after Dot Product</h3>
    <p class="plot-description">
        Combined acceleration signal after calculating the dot product between user acceleration and gravitational acceleration vectors.
    </p>
    <img src="data:image/png;base64,{{ result.dot_product_plot }}" alt="Dot Product Plot">
</div>

<div class="plot-container">
    <h3 class="plot-title">Acceleration after Filtering</h3>
    <p class="plot-description">
        Final filtered signal after applying low-pass and high-pass filters. Steps are detected from the peaks in this signal.
    </p>
    <img src="data:image/png;base64,{{ result.filtered_plot }}" alt="Filtered Plot">
</div>

{% endblock %} 